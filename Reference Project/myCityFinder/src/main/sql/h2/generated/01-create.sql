--
-- (c) Copyright 2005-2012 JAXIO, www.jaxio.com
-- Source code generated by Celerio, a Jaxio product
-- Want to use Celerio within your company? email us at info@jaxio.com
-- Follow us on twitter: @springfuse
-- Template pack-backend:src/main/sql/h2/01-create.p.vm.sql
--
DROP ALL objects;

CREATE TABLE category (
	CATEGORY_ID INTEGER(10) not null
	,NAME VARCHAR(45) not null
	,DESC VARCHAR(45) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON category (CATEGORY_ID);
ALTER TABLE category ALTER COLUMN CATEGORY_ID IDENTITY;

CREATE TABLE photo (
	ID INTEGER(10) not null
	,NAME VARCHAR(26)
	,DESC VARCHAR(100)
	,LOCATION VARCHAR(256) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON photo (ID);
ALTER TABLE photo ALTER COLUMN ID IDENTITY;

CREATE TABLE restaurent (
	RESTAURENT_ID INTEGER(10) not null
	,CODE VARCHAR(10) not null
	,NAME VARCHAR(10) not null
	,DESC VARCHAR(500)
	,PHOTO_ID INTEGER(10)
	,IS_ACTIVE VARCHAR(1)
	,CREATED_DATE TIMESTAMP not null
	,CREATED_BY VARCHAR(26) not null
	,MODIFIED_BY TIMESTAMP
	,MODIFIED_DATE VARCHAR(26)
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON restaurent (RESTAURENT_ID);
CREATE INDEX IF NOT EXISTS FK_restaurent_photo
	ON restaurent (PHOTO_ID);
ALTER TABLE restaurent ALTER COLUMN RESTAURENT_ID IDENTITY;

CREATE TABLE restaurent_category (
	RESTAURENT_ID INTEGER(10) not null
	,CATEGORY_ID INTEGER(10) not null
);
CREATE INDEX IF NOT EXISTS FK_restaurent_category_2
	ON restaurent_category (RESTAURENT_ID);
CREATE INDEX IF NOT EXISTS FK_restaurent_category_1
	ON restaurent_category (CATEGORY_ID);

CREATE TABLE role (
	role_name VARCHAR(26) not null
	,role_id INTEGER(10) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON role (role_id);
ALTER TABLE role ALTER COLUMN role_id IDENTITY;

CREATE TABLE user (
	emailAddress VARCHAR(256) not null
	,password VARCHAR(45) not null
	,enabled VARCHAR(1) not null
	,user_id INTEGER(10) not null
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY
	ON user (user_id);
ALTER TABLE user ALTER COLUMN user_id IDENTITY;

CREATE TABLE user_role (
	user_id INTEGER(10) not null
	,role_id INTEGER(10) not null
);
CREATE INDEX IF NOT EXISTS Index_1
	ON user_role (role_id);
CREATE INDEX IF NOT EXISTS Index_2
	ON user_role (user_id);


ALTER TABLE restaurent 
	ADD CONSTRAINT FK_RESTAURENT_PHOTO
		FOREIGN KEY (PHOTO_ID)
			REFERENCES photo (ID);
ALTER TABLE restaurent_category 
	ADD CONSTRAINT FK_RESTAURENT_CATEGORY_2
		FOREIGN KEY (RESTAURENT_ID)
			REFERENCES restaurent (RESTAURENT_ID);
ALTER TABLE restaurent_category 
	ADD CONSTRAINT FK_RESTAURENT_CATEGORY_1
		FOREIGN KEY (CATEGORY_ID)
			REFERENCES category (CATEGORY_ID);
ALTER TABLE user_role 
	ADD CONSTRAINT FK_USER_ROLE_1
		FOREIGN KEY (user_id)
			REFERENCES user (user_id);
ALTER TABLE user_role 
	ADD CONSTRAINT FK_USER_ROLE_2
		FOREIGN KEY (role_id)
			REFERENCES role (role_id);
